<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip For U - ë‚˜ë§Œì˜ ì—¬í–‰ í”Œë˜ë„ˆ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* ===== Global Reset & Base Styles ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: #1F2937;
            background-color: #F9FAFB;
        }

        /* ===== Layout Structure ===== */
        .dashboard-container {
            display: flex;
            flex-direction: row;
            min-height: 100vh;
        }

        /* ===== Sidebar Styles ===== */
        .sidebar {
            width: 375px;
            background-color: #FFFFFF;
            border-right: 1px solid #E5E7EB;
            padding: 32px;
            overflow-y: auto;
        }

        .sidebar-header {
            margin-bottom: 32px;
        }

        .sidebar-header h1 {
            font-size: 24px;
            font-weight: 700;
            color: #2563EB;
            margin-bottom: 4px;
        }

        .sidebar-header p {
            font-size: 14px;
            color: #6B7280;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #6B7280;
            margin-bottom: 8px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: 1px solid #E5E7EB;
            border-radius: 4px;
            background-color: #FFFFFF;
            color: #1F2937;
            font-family: inherit;
            transition: border-color 0.3s, background-color 0.3s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #2563EB;
            background-color: #F9FAFB;
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .date-time-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* Transport Button Group */
        .transport-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .transport-btn {
            padding: 10px 16px;
            font-size: 14px;
            border: 1px solid #E5E7EB;
            border-radius: 4px;
            background-color: #FFFFFF;
            color: #1F2937;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .transport-btn:hover {
            background-color: #F9FAFB;
            border-color: #2563EB;
        }

        .transport-btn.active {
            background-color: #2563EB;
            color: #FFFFFF;
            border-color: #2563EB;
        }

        /* Slider Styles */
        .slider-group {
            margin-bottom: 16px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .slider-label span {
            font-size: 12px;
            color: #6B7280;
        }

        .slider-label .slider-value {
            font-weight: 600;
            color: #2563EB;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #E5E7EB;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2563EB;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2563EB;
            cursor: pointer;
            border: none;
        }

        /* Primary Button */
        .btn-primary {
            width: 100%;
            padding: 14px 24px;
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            background-color: #2563EB;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            font-family: inherit;
        }

        .btn-primary:hover {
            background-color: #1D4ED8;
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* ===== Main Content Area ===== */
        .main-content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
        }

        /* Main Header */
        .main-header {
            background-color: #FFFFFF;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            border: 1px solid #E5E7EB;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-top h2 {
            font-size: 22px;
            font-weight: 700;
            color: #1F2937;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .btn-secondary {
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            color: #1F2937;
            background-color: transparent;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .btn-secondary:hover {
            background-color: #F9FAFB;
            border-color: #2563EB;
            color: #2563EB;
        }

        .header-date {
            font-size: 14px;
            color: #6B7280;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 24px;
            border-bottom: 2px solid #E5E7EB;
            margin-bottom: 24px;
            background-color: #FFFFFF;
            padding: 16px 24px 0;
            border-radius: 8px 8px 0 0;
            border: 1px solid #E5E7EB;
            border-bottom: none;
        }

        .tab {
            padding: 12px 16px;
            font-size: 15px;
            font-weight: 600;
            color: #6B7280;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 0.3s;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
            font-family: inherit;
        }

        .tab:hover {
            color: #2563EB;
        }

        .tab.active {
            color: #2563EB;
            border-bottom-color: #2563EB;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Schedule Cards */
        .schedule-cards {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .schedule-card {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s, transform 0.2s;
        }

        .schedule-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .card-time {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .time-badge {
            background-color: #F3F4F6;
            color: #6B7280;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
        }

        .travel-time {
            font-size: 13px;
            color: #6B7280;
        }

        .card-badges {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-weather {
            background-color: #DBEAFE;
            color: #1E40AF;
        }

        .badge-fatigue {
            background-color: #FEF3C7;
            color: #92400E;
        }

        .card-body {
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 12px;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }

        .tag {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .tag-red {
            background-color: #FEE2E2;
            color: #DC2626;
        }

        .tag-blue {
            background-color: #DBEAFE;
            color: #0891B2;
        }

        .tag-green {
            background-color: #D1FAE5;
            color: #059669;
        }

        .card-description {
            font-size: 14px;
            color: #4B5563;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .card-link {
            color: #2563EB;
            font-size: 14px;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .card-link:hover {
            color: #1D4ED8;
            text-decoration: underline;
        }

        .card-footer {
            padding-top: 12px;
            border-top: 1px solid #E5E7EB;
            font-size: 13px;
            color: #6B7280;
        }

        /* Fatigue Gauge */
        .fatigue-gauge-container {
            margin-bottom: 24px;
            padding: 16px;
            background-color: #F9FAFB;
            border-radius: 8px;
            border: 1px solid #E5E7EB;
        }

        .fatigue-label {
            font-size: 14px;
            font-weight: 600;
            color: #6B7280;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }

        .fatigue-value {
            font-weight: 700;
            font-size: 16px;
        }

        .fatigue-value.low {
            color: #10B981;
        }

        .fatigue-value.medium {
            color: #F59E0B;
        }

        .fatigue-value.high {
            color: #EF4444;
        }

        .fatigue-bar {
            width: 100%;
            height: 12px;
            background-color: #E5E7EB;
            border-radius: 6px;
            overflow: hidden;
        }

        .fatigue-fill {
            height: 100%;
            transition: width 0.5s ease, background-color 0.5s ease;
            border-radius: 6px;
        }

        .fatigue-fill.low {
            background-color: #10B981;
        }

        .fatigue-fill.medium {
            background-color: #F59E0B;
        }

        .fatigue-fill.high {
            background-color: #EF4444;
        }

        /* Weather Display */
        .weather-display {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #6B7280;
        }

        .weather-icon {
            font-size: 24px;
        }

        /* Arrival Button */
        .btn-arrival {
            margin-top: 12px;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 500;
            color: #FFFFFF;
            background-color: #10B981;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .btn-arrival:hover {
            background-color: #059669;
        }

        .btn-arrival:disabled {
            background-color: #9CA3AF;
            cursor: not-allowed;
        }

        .schedule-card.arrived {
            background-color: #F0FDF4;
            border-color: #10B981;
        }

        .schedule-card.current {
            background-color: #FEF3C7;
            border-color: #F59E0B;
        }

        /* Input number for sliders */
        .slider-input {
            width: 50px;
            padding: 2px 6px;
            font-size: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 3px;
            text-align: center;
        }

        .slider-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ===== Responsive Design ===== */

        /* Tablet (768px - 1023px) */
        @media (max-width: 1023px) and (min-width: 768px) {
            .sidebar {
                width: 300px;
                padding: 24px;
            }

            .main-content {
                padding: 24px;
            }
        }

        /* Mobile (768px and below) */
        @media (max-width: 767px) {
            .dashboard-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                max-height: 500px;
                border-right: none;
                border-bottom: 1px solid #E5E7EB;
                padding: 24px;
            }

            .main-content {
                padding: 20px;
            }

            .main-header {
                padding: 16px;
            }

            .header-top {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-top h2 {
                font-size: 18px;
            }

            .header-actions {
                width: 100%;
                flex-wrap: wrap;
            }

            .btn-secondary {
                flex: 1;
                min-width: 120px;
            }

            .tabs {
                padding: 12px 16px 0;
                overflow-x: auto;
                flex-wrap: nowrap;
            }

            .tab {
                padding: 10px 12px;
                font-size: 14px;
                white-space: nowrap;
            }

            .schedule-card {
                padding: 16px;
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .card-title {
                font-size: 16px;
            }

            .transport-buttons {
                grid-template-columns: 1fr;
            }

            .date-time-group {
                grid-template-columns: 1fr;
            }
        }

        /* Very small mobile (480px and below) */
        @media (max-width: 480px) {
            .sidebar {
                padding: 16px;
            }

            .main-content {
                padding: 16px;
            }

            .card-time {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>Trip For U</h1>
                <p>ë‚˜ë§Œì˜ ë§ì¶¤ ì—¬í–‰ í”Œë˜ë„ˆ</p>
            </div>

            <form>
                <!-- Departure and Destination -->
                <div class="form-group">
                    <label class="form-label" for="departure">ì¶œë°œì§€</label>
                    <input type="text" class="form-input" id="departure" placeholder="ì˜ˆ: ëŒ€ì „" value="ëŒ€ì „">
                </div>

                <div class="form-group">
                    <label class="form-label" for="destination">ë„ì°©ì§€</label>
                    <input type="text" class="form-input" id="destination" placeholder="ì˜ˆ: ì„œìš¸" value="ì„œìš¸">
                </div>

                <!-- Travel Dates -->
                <div class="form-group">
                    <label class="form-label">ì—¬í–‰ ê¸°ê°„</label>
                    <div class="date-time-group">
                        <div>
                            <label class="form-label" style="font-size: 12px; margin-bottom: 4px;">ì‹œì‘ì¼</label>
                            <input type="date" class="form-input" id="start-date" value="2025-11-17">
                        </div>
                        <div>
                            <label class="form-label" style="font-size: 12px; margin-bottom: 4px;">ì¢…ë£Œì¼</label>
                            <input type="date" class="form-input" id="end-date" value="2025-11-19">
                        </div>
                    </div>
                </div>

                <!-- Travel Times -->
                <div class="form-group">
                    <label class="form-label">ì—¬í–‰ ì‹œê°„</label>
                    <div class="date-time-group">
                        <div>
                            <label class="form-label" style="font-size: 12px; margin-bottom: 4px;">ì¶œë°œ ì‹œê°„</label>
                            <input type="time" class="form-input" id="start-time" value="09:00">
                        </div>
                        <div>
                            <label class="form-label" style="font-size: 12px; margin-bottom: 4px;">ë„ì°© ì‹œê°„</label>
                            <input type="time" class="form-input" id="end-time" value="18:00">
                        </div>
                    </div>
                </div>

                <!-- Transport Method -->
                <div class="form-group">
                    <label class="form-label">ì´ë™ ìˆ˜ë‹¨</label>
                    <div class="transport-buttons">
                        <button type="button" class="transport-btn active">ìì°¨</button>
                        <button type="button" class="transport-btn">ë²„ìŠ¤</button>
                        <button type="button" class="transport-btn">KTX/ê¸°ì°¨</button>
                        <button type="button" class="transport-btn">ë„ë³´</button>
                    </div>
                </div>

                <!-- Preference Sliders -->
                <div class="form-group">
                    <label class="form-label">ì·¨í–¥ ë¹„ì¤‘ (ì´í•©: <span id="total-percentage">100</span>%)</label>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>ë§›ì§‘</span>
                            <div class="slider-controls">
                                <span class="slider-value" data-slider="food">40%</span>
                                <input type="number" class="slider-input" min="0" max="100" value="40" data-input="food">
                            </div>
                        </div>
                        <input type="range" class="slider" min="0" max="100" value="40" data-slider="food">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>ê´€ê´‘</span>
                            <div class="slider-controls">
                                <span class="slider-value" data-slider="sight">30%</span>
                                <input type="number" class="slider-input" min="0" max="100" value="30" data-input="sight">
                            </div>
                        </div>
                        <input type="range" class="slider" min="0" max="100" value="30" data-slider="sight">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>ì‡¼í•‘</span>
                            <div class="slider-controls">
                                <span class="slider-value" data-slider="shopping">15%</span>
                                <input type="number" class="slider-input" min="0" max="100" value="15" data-input="shopping">
                            </div>
                        </div>
                        <input type="range" class="slider" min="0" max="100" value="15" data-slider="shopping">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>ì¹´í˜/íœ´ì‹</span>
                            <div class="slider-controls">
                                <span class="slider-value" data-slider="cafe">15%</span>
                                <input type="number" class="slider-input" min="0" max="100" value="15" data-input="cafe">
                            </div>
                        </div>
                        <input type="range" class="slider" min="0" max="100" value="15" data-slider="cafe">
                    </div>
                </div>

                <!-- Fatigue Gauge -->
                <div class="fatigue-gauge-container">
                    <div class="fatigue-label">
                        <span>ì˜ˆìƒ í”¼ë¡œë„</span>
                        <span class="fatigue-value low" id="fatigue-value">42ì  (ë‚®ìŒ)</span>
                    </div>
                    <div class="fatigue-bar">
                        <div class="fatigue-fill low" id="fatigue-fill" style="width: 42%"></div>
                    </div>
                </div>

                <!-- Interests -->
                <div class="form-group">
                    <label class="form-label" for="interests">ê´€ì‹¬ì‚¬ ë° ì„ í˜¸ì‚¬í•­</label>
                    <textarea class="form-textarea" id="interests" placeholder="ì˜ˆ: í•œì‹ ì„ í˜¸, ê±·ê¸° ì¢‹ì•„í•¨, ì—­ì‚¬ì ì¸ ì¥ì†Œ ê´€ì‹¬"></textarea>
                </div>

                <!-- Notes -->
                <div class="form-group">
                    <label class="form-label" for="notes">ì¶”ê°€ ìš”ì²­ì‚¬í•­</label>
                    <textarea class="form-textarea" id="notes" placeholder="ì˜ˆ: ì£¼ì°¨ ê°€ëŠ¥í•œ ê³³ ìœ„ì£¼ë¡œ, ì•„ì´ì™€ í•¨ê»˜ ê°€ê¸° ì¢‹ì€ ê³³"></textarea>
                </div>

                <!-- Generate Button -->
                <button type="button" class="btn-primary">ì—¬í–‰ ì¼ì • ìƒì„±</button>
            </form>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="main-header">
                <div class="header-top">
                    <h2 id="trip-title">ì„œìš¸ 2ë°• 3ì¼ ìì°¨ ì´ìš© ë§›ì§‘ & ë¬¸í™” íƒë°©</h2>
                    <div class="header-actions">
                        <div class="weather-display">
                            <span class="weather-icon" id="weather-icon">â˜€ï¸</span>
                            <span id="weather-temp">22Â°C</span>
                            <span id="weather-condition">ë§‘ìŒ</span>
                        </div>
                        <button class="btn-secondary" id="btn-weather-alternative">â˜” ë¹„ì˜¤ëŠ” ë‚ ì”¨</button>
                        <button class="btn-secondary" id="btn-pdf">ğŸ“„ PDF ì €ì¥</button>
                        <button class="btn-secondary" id="btn-regenerate">ğŸ”„ ì¼ì • ì¬êµ¬ì„±</button>
                    </div>
                </div>
                <p class="header-date" id="trip-dates">2025ë…„ 11ì›” 17ì¼ - 11ì›” 19ì¼</p>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active">1ì¼ì°¨</button>
                <button class="tab">2ì¼ì°¨</button>
                <button class="tab">3ì¼ì°¨</button>
            </div>

            <!-- Tab Content - Day 1 -->
            <div class="tab-content active">
                <div class="schedule-cards">
                    <!-- Card 1 -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">09:00 - 11:00 (120ë¶„)</span>
                                <span class="travel-time">ì„œìš¸ ì‹œë‚´ ì´ë™ 30ë¶„</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-weather">ë§‘ìŒ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ëŒ€ì „ì—ì„œ ì„œìš¸ë¡œ ì´ë™</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ì—¬í–‰_ì‹œì‘</span>
                                <span class="tag tag-blue">#í¸ì˜ì </span>
                            </div>
                            <p class="card-description">
                                ìì°¨ë¡œ ëŒ€ì „ì—ì„œ ì„œìš¸ê¹Œì§€ 2ì‹œê°„ ì†Œìš”ë©ë‹ˆë‹¤. ê²½ë¶€ê³ ì†ë„ë¡œë¥¼ ì´ìš©í•˜ì—¬, ì„œìš¸ ì‹œì²­ ë¶€ê·¼ ë„ì°©ì„ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.
                                ì¤‘ê°„ì— íœ´ê²Œì†Œì—ì„œ íœ´ì‹ì„ ì·¨í•˜ë©° í¸ì˜ì ì—ì„œ ê°„ì‹ì„ ì¤€ë¹„í•˜ì„¸ìš”.
                            </p>
                            <a href="#" class="card-link">ê²½ë¡œ í™•ì¸í•˜ê¸° â†’</a>
                        </div>
                    </div>

                    <!-- Card 2 -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">11:30 - 12:30 (60ë¶„)</span>
                                <span class="travel-time">ì´ë™ 10ë¶„</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-fatigue">í”¼ë¡œë„ ë‚®ìŒ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ë´‰í”¼ì–‘ ë°©ì´ì </h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ê°€ì¡±ì¹œí™”</span>
                                <span class="tag tag-blue">#ë¼ì§€ê°ˆë¹„</span>
                                <span class="tag tag-green">#ì£¼ì°¨_ê°€ëŠ¥</span>
                            </div>
                            <p class="card-description">
                                ë´‰í”¼ì–‘ ë¼ì§€ê°ˆë¹„ëŠ” ì„œìš¸ì—ì„œ ìœ ëª…í•œ ë§›ì§‘ì…ë‹ˆë‹¤. ì ì‹¬ ì‹ì‚¬ë¥¼ ì¦ê¸°ê¸°ì— ì¢‹ìœ¼ë©°, ë„‰ë„‰í•œ ì£¼ì°¨ ê³µê°„ì´ ë§ˆë ¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                                ë§›ìˆëŠ” ë¼ì§€ê°ˆë¹„ì™€ í•¨ê»˜ ë‹¤ì–‘í•œ ë°˜ì°¬ì„ ì¦ê¸°ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                            </p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 15,000ì›
                        </div>
                    </div>

                    <!-- Card 3 -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">12:40 - 15:10 (150ë¶„)</span>
                                <span class="travel-time">ì°¨ëŸ‰ ì´ë™ 15ë¶„</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-weather">ë§‘ìŒ</span>
                                <span class="badge badge-fatigue">í”¼ë¡œë„ ë³´í†µ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ë¡¯ë°ì›”ë“œíƒ€ì›Œ & ì„œìš¸ìŠ¤ì¹´ì´</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ëœë“œë§ˆí¬</span>
                                <span class="tag tag-blue">#ê´€ê´‘ëª…ì†Œ</span>
                                <span class="tag tag-green">#ì „ë§ëŒ€</span>
                            </div>
                            <p class="card-description">
                                ì„œìš¸ì˜ ëœë“œë§ˆí¬ì—ì„œ íƒ íŠ¸ì¸ ì „ê²½ì„ ê°ìƒí•˜ì„¸ìš”. ë¡¯ë°ì›”ë“œíƒ€ì›Œ ì§€í•˜ ì£¼ì°¨ì¥ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                123ì¸µ ì „ë§ëŒ€ì—ì„œ ì„œìš¸ì˜ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ í•œëˆˆì— ë‹´ì•„ë³´ì„¸ìš”. ë‚ ì”¨ê°€ ë§‘ìœ¼ë©´ ì¸ì²œê¹Œì§€ ë³´ì…ë‹ˆë‹¤.
                            </p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ì…ì¥ë£Œ: ì„±ì¸ 27,000ì› | ì£¼ì°¨: ì²« 2ì‹œê°„ ë¬´ë£Œ
                        </div>
                    </div>

                    <!-- Card 4 -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">15:30 - 16:30 (60ë¶„)</span>
                                <span class="travel-time">ë„ë³´ 5ë¶„</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ì„±ìˆ˜ë™ ì¹´í˜ íƒë°©</h3>
                            <div class="card-tags">
                                <span class="tag tag-blue">#ì¹´í˜</span>
                                <span class="tag tag-green">#ë””ì €íŠ¸</span>
                                <span class="tag tag-red">#í¬í† ìŠ¤íŒŸ</span>
                            </div>
                            <p class="card-description">
                                í™í•œ ì„±ìˆ˜ë™ ì¹´í˜ê±°ë¦¬ì—ì„œ ì—¬ìœ ë¡œìš´ ì»¤í”¼ íƒ€ì„ì„ ì¦ê²¨ë³´ì„¸ìš”.
                                ë‹¤ì–‘í•œ ê°ì„± ì¹´í˜ë“¤ì´ ëª¨ì—¬ìˆì–´ ì¸ìŠ¤íƒ€ê·¸ë¨ ê°ì„± ì‚¬ì§„ë„ ë‚¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                            </p>
                            <a href="#" class="card-link">ì£¼ë³€ ì¹´í˜ ì°¾ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 8,000ì›
                        </div>
                    </div>

                    <!-- Card 5 -->
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">18:00 - 19:30 (90ë¶„)</span>
                                <span class="travel-time">ì°¨ëŸ‰ ì´ë™ 20ë¶„</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-fatigue">í”¼ë¡œë„ ë†’ìŒ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ë‚¨ì‚°íƒ€ì›Œ ì•¼ê²½ ê°ìƒ</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ì•¼ê²½</span>
                                <span class="tag tag-blue">#ë°ì´íŠ¸ì½”ìŠ¤</span>
                                <span class="tag tag-green">#ì¶”ì–µ</span>
                            </div>
                            <p class="card-description">
                                í•˜ë£¨ì˜ ë§ˆë¬´ë¦¬ë¡œ ë‚¨ì‚°íƒ€ì›Œì—ì„œ ì•„ë¦„ë‹¤ìš´ ì„œìš¸ ì•¼ê²½ì„ ê°ìƒí•˜ì„¸ìš”.
                                ì¼€ì´ë¸”ì¹´ë¥¼ íƒ€ê³  ì˜¬ë¼ê°€ë©´ ë”ìš± ë¡œë§¨í‹±í•œ ë¶„ìœ„ê¸°ë¥¼ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ë‘ì˜ ìë¬¼ì‡ ë„ ìŠì§€ ë§ˆì„¸ìš”.
                            </p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ì¼€ì´ë¸”ì¹´: ì™•ë³µ 11,000ì› | íƒ€ì›Œ ì…ì¥ë£Œ: 16,000ì›
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Content - Day 2 -->
            <div class="tab-content">
                <div class="schedule-cards">
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">09:00 - 10:30 (90ë¶„)</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-weather">ë§‘ìŒ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ê²½ë³µê¶ & êµ­ë¦½ë¯¼ì†ë°•ë¬¼ê´€</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ì—­ì‚¬</span>
                                <span class="tag tag-blue">#ë¬¸í™”</span>
                                <span class="tag tag-green">#í•œë³µì²´í—˜</span>
                            </div>
                            <p class="card-description">
                                ì¡°ì„  ì‹œëŒ€ì˜ ëŒ€í‘œ ê¶ê¶ì¸ ê²½ë³µê¶ì„ ë‘˜ëŸ¬ë³´ë©° í•œêµ­ì˜ ì—­ì‚¬ë¥¼ ì²´í—˜í•´ë³´ì„¸ìš”.
                                í•œë³µì„ ì…ê³  ë°©ë¬¸í•˜ë©´ ë¬´ë£Œ ì…ì¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                            </p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ì…ì¥ë£Œ: 3,000ì› | í•œë³µ ì°©ìš© ì‹œ ë¬´ë£Œ
                        </div>
                    </div>

                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">11:00 - 12:30 (90ë¶„)</span>
                                <span class="travel-time">ë„ë³´ 10ë¶„</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ë¶ì´Œ í•œì˜¥ë§ˆì„ ì‚°ì±…</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#í•œì˜¥</span>
                                <span class="tag tag-blue">#í¬í† ì¡´</span>
                                <span class="tag tag-green">#ì „í†µ</span>
                            </div>
                            <p class="card-description">
                                ì „í†µ í•œì˜¥ì´ ì˜ ë³´ì¡´ëœ ë¶ì´Œì—ì„œ ê³ ì¦ˆë„‰í•œ ì‚°ì±…ì„ ì¦ê²¨ë³´ì„¸ìš”.
                                ì‚¬ì§„ ì´¬ì˜í•˜ê¸° ì¢‹ì€ ëª…ì†Œë“¤ì´ ë§ì•„ ì¶”ì–µì„ ë‚¨ê¸°ê¸° ì™„ë²½í•©ë‹ˆë‹¤.
                            </p>
                            <a href="#" class="card-link">ì¶”ì²œ í¬í†  ìŠ¤íŒŸ ë³´ê¸° â†’</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Content - Day 3 -->
            <div class="tab-content">
                <div class="schedule-cards">
                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">09:00 - 11:00 (120ë¶„)</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-weather">íë¦¼</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ì½”ì—‘ìŠ¤ ìŠ¤íƒ€í•„ë“œ & ë³„ë§ˆë‹¹ ë„ì„œê´€</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ì‡¼í•‘</span>
                                <span class="tag tag-blue">#ë„ì„œê´€</span>
                                <span class="tag tag-green">#ì‹¤ë‚´</span>
                            </div>
                            <p class="card-description">
                                ì•„ì‹œì•„ ìµœëŒ€ ê·œëª¨ì˜ ì§€í•˜ ì‡¼í•‘ëª° ì½”ì—‘ìŠ¤ì—ì„œ ì‡¼í•‘ê³¼ í•¨ê»˜ ë³„ë§ˆë‹¹ ë„ì„œê´€ì„ ë°©ë¬¸í•´ë³´ì„¸ìš”.
                                ë…íŠ¹í•œ ê±´ì¶•ë¯¸ê°€ ë‹ë³´ì´ëŠ” ë„ì„œê´€ì—ì„œ ì¸ìƒ ì‚¬ì§„ì„ ë‚¨ê²¨ë³´ì„¸ìš”.
                            </p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        <div class="card-footer">
                            ë¬´ë£Œ ì…ì¥ | ì£¼ì°¨: ì‹œê°„ë‹¹ 3,000ì›
                        </div>
                    </div>

                    <div class="schedule-card">
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">14:00 - 16:00 (120ë¶„)</span>
                                <span class="travel-time">ì°¨ëŸ‰ ì´ë™ 120ë¶„</span>
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-fatigue">í”¼ë¡œë„ ë†’ìŒ</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">ì„œìš¸ì—ì„œ ëŒ€ì „ìœ¼ë¡œ ë³µê·€</h3>
                            <div class="card-tags">
                                <span class="tag tag-red">#ê·€ê°€</span>
                                <span class="tag tag-blue">#ì—¬í–‰_ë§ˆë¬´ë¦¬</span>
                            </div>
                            <p class="card-description">
                                ì¦ê±°ì› ë˜ ì„œìš¸ ì—¬í–‰ì„ ë§ˆë¬´ë¦¬í•˜ê³  ëŒ€ì „ìœ¼ë¡œ ë³µê·€í•©ë‹ˆë‹¤.
                                ê²½ë¶€ê³ ì†ë„ë¡œë¥¼ ì´ìš©í•˜ì—¬ ì•ˆì „í•˜ê²Œ ê·€ê°€í•˜ì„¸ìš”. íœ´ê²Œì†Œì—ì„œ ë§ˆì§€ë§‰ íœ´ì‹ì„ ì·¨í•˜ë©° ì—¬í–‰ì˜ ì—¬ìš´ì„ ì¦ê²¨ë³´ì„¸ìš”.
                            </p>
                            <a href="#" class="card-link">ê²½ë¡œ í™•ì¸í•˜ê¸° â†’</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ===== API Configuration =====
        const API_URL = window.location.origin;  // Use same origin as page

        // ===== Global State =====
        const state = {
            preferences: {
                food: 40,
                sight: 30,
                shopping: 15,
                cafe: 15
            },
            currentTab: 0,
            transport: 'ìì°¨',
            weather: 'sunny',
            arrivedActivities: [],
            activities: []  // Will be loaded from API
        };

        // ===== API Functions =====
        async function fetchActivities(category = null, indoor = null) {
            let url = `${API_URL}/api/activities`;
            const params = new URLSearchParams();

            if (category) params.append('category', category);
            if (indoor !== null) params.append('indoor', indoor);

            if (params.toString()) url += '?' + params.toString();

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Failed to fetch activities');
                return await response.json();
            } catch (error) {
                console.error('Error fetching activities:', error);
                return [];
            }
        }

        async function generateItineraryAPI(preferences, days = 3, weather = 'sunny') {
            // Get form values
            const departure = document.getElementById('departure').value || 'ëŒ€ì „';
            const destination = document.getElementById('destination').value || 'ì„œìš¸';
            const startDate = document.getElementById('start-date').value || '2025-11-17';
            const endDate = document.getElementById('end-date').value || '2025-11-19';
            const startTime = document.getElementById('start-time').value || '09:00';
            const endTime = document.getElementById('end-time').value || '18:00';
            const transport = state.transport || 'ìì°¨';
            const interests = document.getElementById('interests').value || '';
            const notes = document.getElementById('notes').value || '';

            try {
                // Try Gemini AI first
                const aiResponse = await fetch(`${API_URL}/api/generate-itinerary-ai`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        departure,
                        destination,
                        start_date: startDate,
                        end_date: endDate,
                        start_time: startTime,
                        end_time: endTime,
                        transport,
                        preferences,
                        interests,
                        notes,
                        weather
                    })
                });

                if (aiResponse.ok) {
                    const data = await aiResponse.json();
                    if (data.error) {
                        console.warn('Gemini API error, falling back to basic algorithm:', data.error);
                        throw new Error(data.error);
                    }
                    console.log('âœ… Gemini AIë¡œ ì¼ì • ìƒì„± ì™„ë£Œ');
                    return data.days;
                }

                // Fallback to basic algorithm
                throw new Error('AI API failed');

            } catch (error) {
                console.log('âš ï¸  AI ì‚¬ìš© ë¶ˆê°€, ê¸°ë³¸ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©');

                // Fallback to basic algorithm
                const response = await fetch(`${API_URL}/api/generate-itinerary`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ preferences, days, weather })
                });

                if (!response.ok) throw new Error('Failed to generate itinerary');
                const data = await response.json();
                return data.days;
            }
        }

        // ===== Fallback Activity Database (if API fails) =====
        const activityDatabaseFallback = {
            food: [
                {
                    title: 'ë´‰í”¼ì–‘ ë°©ì´ì ',
                    duration: 60,
                    category: 'food',
                    tags: ['#ê°€ì¡±ì¹œí™”', '#ë¼ì§€ê°ˆë¹„', '#ì£¼ì°¨_ê°€ëŠ¥'],
                    description: 'ë´‰í”¼ì–‘ ë¼ì§€ê°ˆë¹„ëŠ” ì„œìš¸ì—ì„œ ìœ ëª…í•œ ë§›ì§‘ì…ë‹ˆë‹¤. ì ì‹¬ ì‹ì‚¬ë¥¼ ì¦ê¸°ê¸°ì— ì¢‹ìœ¼ë©°, ë„‰ë„‰í•œ ì£¼ì°¨ ê³µê°„ì´ ë§ˆë ¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 15,000ì›',
                    indoor: true
                },
                {
                    title: 'ê´‘ì¥ì‹œì¥ ë¨¹ê±°ë¦¬',
                    duration: 90,
                    category: 'food',
                    tags: ['#ì „í†µì‹œì¥', '#ê¸¸ê±°ë¦¬ìŒì‹', '#ë‹¤ì–‘í•œë©”ë‰´'],
                    description: 'ë§ˆì•½ê¹€ë°¥, ë¹ˆëŒ€ë–¡, ìœ¡íšŒ ë“± ë‹¤ì–‘í•œ ì „í†µ ë¨¹ê±°ë¦¬ë¥¼ í•œ ê³³ì—ì„œ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 20,000ì›',
                    indoor: false
                },
                {
                    title: 'ì„ì§€ë¡œ ë…¸ê°€ë¦¬ê³¨ëª©',
                    duration: 120,
                    category: 'food',
                    tags: ['#ì•¼ê²½', '#ë…¸ê°€ë¦¬', '#ë¶„ìœ„ê¸°'],
                    description: 'ì„œìš¸ì˜ ë ˆíŠ¸ë¡œ ê°ì„±ì´ ë¬¼ì”¬ í’ê¸°ëŠ” ì„ì§€ë¡œì—ì„œ ë…¸ê°€ë¦¬ì™€ í•¨ê»˜ ì €ë…ì„ ì¦ê²¨ë³´ì„¸ìš”.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 25,000ì›',
                    indoor: false
                }
            ],
            sight: [
                {
                    title: 'ë¡¯ë°ì›”ë“œíƒ€ì›Œ & ì„œìš¸ìŠ¤ì¹´ì´',
                    duration: 150,
                    category: 'sight',
                    tags: ['#ëœë“œë§ˆí¬', '#ê´€ê´‘ëª…ì†Œ', '#ì „ë§ëŒ€'],
                    description: 'ì„œìš¸ì˜ ëœë“œë§ˆí¬ì—ì„œ íƒ íŠ¸ì¸ ì „ê²½ì„ ê°ìƒí•˜ì„¸ìš”. 123ì¸µ ì „ë§ëŒ€ì—ì„œ ì„œìš¸ì˜ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ í•œëˆˆì— ë‹´ì•„ë³´ì„¸ìš”.',
                    footer: 'ì…ì¥ë£Œ: ì„±ì¸ 27,000ì› | ì£¼ì°¨: ì²« 2ì‹œê°„ ë¬´ë£Œ',
                    indoor: true
                },
                {
                    title: 'ê²½ë³µê¶ & êµ­ë¦½ë¯¼ì†ë°•ë¬¼ê´€',
                    duration: 90,
                    category: 'sight',
                    tags: ['#ì—­ì‚¬', '#ë¬¸í™”', '#í•œë³µì²´í—˜'],
                    description: 'ì¡°ì„  ì‹œëŒ€ì˜ ëŒ€í‘œ ê¶ê¶ì¸ ê²½ë³µê¶ì„ ë‘˜ëŸ¬ë³´ë©° í•œêµ­ì˜ ì—­ì‚¬ë¥¼ ì²´í—˜í•´ë³´ì„¸ìš”.',
                    footer: 'ì…ì¥ë£Œ: 3,000ì› | í•œë³µ ì°©ìš© ì‹œ ë¬´ë£Œ',
                    indoor: false
                },
                {
                    title: 'ë‚¨ì‚°íƒ€ì›Œ ì•¼ê²½ ê°ìƒ',
                    duration: 90,
                    category: 'sight',
                    tags: ['#ì•¼ê²½', '#ë°ì´íŠ¸ì½”ìŠ¤', '#ì¶”ì–µ'],
                    description: 'ì¼€ì´ë¸”ì¹´ë¥¼ íƒ€ê³  ì˜¬ë¼ê°€ ë‚¨ì‚°íƒ€ì›Œì—ì„œ ì„œìš¸ ì•¼ê²½ì„ ê°ìƒí•˜ì„¸ìš”.',
                    footer: 'ì¼€ì´ë¸”ì¹´: ì™•ë³µ 11,000ì› | íƒ€ì›Œ ì…ì¥ë£Œ: 16,000ì›',
                    indoor: false
                },
                {
                    title: 'ë¶ì´Œ í•œì˜¥ë§ˆì„ ì‚°ì±…',
                    duration: 90,
                    category: 'sight',
                    tags: ['#í•œì˜¥', '#í¬í† ì¡´', '#ì „í†µ'],
                    description: 'ì „í†µ í•œì˜¥ì´ ì˜ ë³´ì¡´ëœ ë¶ì´Œì—ì„œ ê³ ì¦ˆë„‰í•œ ì‚°ì±…ì„ ì¦ê²¨ë³´ì„¸ìš”.',
                    footer: '',
                    indoor: false
                }
            ],
            shopping: [
                {
                    title: 'ì½”ì—‘ìŠ¤ ìŠ¤íƒ€í•„ë“œ & ë³„ë§ˆë‹¹ ë„ì„œê´€',
                    duration: 120,
                    category: 'shopping',
                    tags: ['#ì‡¼í•‘', '#ë„ì„œê´€', '#ì‹¤ë‚´'],
                    description: 'ì•„ì‹œì•„ ìµœëŒ€ ê·œëª¨ì˜ ì§€í•˜ ì‡¼í•‘ëª° ì½”ì—‘ìŠ¤ì—ì„œ ì‡¼í•‘ê³¼ í•¨ê»˜ ë³„ë§ˆë‹¹ ë„ì„œê´€ì„ ë°©ë¬¸í•´ë³´ì„¸ìš”.',
                    footer: 'ë¬´ë£Œ ì…ì¥ | ì£¼ì°¨: ì‹œê°„ë‹¹ 3,000ì›',
                    indoor: true
                },
                {
                    title: 'ëª…ë™ ì‡¼í•‘ê±°ë¦¬',
                    duration: 150,
                    category: 'shopping',
                    tags: ['#ì‡¼í•‘', '#í™”ì¥í’ˆ', '#íŒ¨ì…˜'],
                    description: 'ì„œìš¸ì˜ ëŒ€í‘œ ì‡¼í•‘ ê±°ë¦¬ ëª…ë™ì—ì„œ ì‡¼í•‘ì„ ì¦ê²¨ë³´ì„¸ìš”.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: ê°œì¸ë³„ ìƒì´',
                    indoor: false
                },
                {
                    title: 'í™ëŒ€ ê±°ë¦¬ ì‡¼í•‘',
                    duration: 120,
                    category: 'shopping',
                    tags: ['#ì Šì€ê±°ë¦¬', '#ê°œì„±ìˆëŠ”ìƒí’ˆ', '#ë²„ìŠ¤í‚¹'],
                    description: 'íŠ¸ë Œë””í•œ í™ëŒ€ì—ì„œ ë…íŠ¹í•œ ì•„ì´í…œë“¤ì„ êµ¬ê²½í•˜ê³  êµ¬ë§¤í•´ë³´ì„¸ìš”.',
                    footer: '',
                    indoor: false
                }
            ],
            cafe: [
                {
                    title: 'ì„±ìˆ˜ë™ ì¹´í˜ íƒë°©',
                    duration: 60,
                    category: 'cafe',
                    tags: ['#ì¹´í˜', '#ë””ì €íŠ¸', '#í¬í† ìŠ¤íŒŸ'],
                    description: 'í™í•œ ì„±ìˆ˜ë™ ì¹´í˜ê±°ë¦¬ì—ì„œ ì—¬ìœ ë¡œìš´ ì»¤í”¼ íƒ€ì„ì„ ì¦ê²¨ë³´ì„¸ìš”.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 8,000ì›',
                    indoor: true
                },
                {
                    title: 'ì´íƒœì› ë£¨í”„íƒ‘ ì¹´í˜',
                    duration: 90,
                    category: 'cafe',
                    tags: ['#ë£¨í”„íƒ‘', '#ë·°ë§›ì§‘', '#ë‚­ë§Œ'],
                    description: 'ì´íƒœì›ì˜ ë©‹ì§„ ë£¨í”„íƒ‘ ì¹´í˜ì—ì„œ ì„œìš¸ ì‹œë‚´ë¥¼ ë‚´ë ¤ë‹¤ë³´ë©° ì»¤í”¼ë¥¼ ì¦ê¸°ì„¸ìš”.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 12,000ì›',
                    indoor: true
                },
                {
                    title: 'ë¶ì´Œ ì „í†µì°»ì§‘',
                    duration: 60,
                    category: 'cafe',
                    tags: ['#ì „í†µì°¨', '#í•œì˜¥ì¹´í˜', '#íë§'],
                    description: 'í•œì˜¥ì„ ê°œì¡°í•œ ì „í†µ ì°»ì§‘ì—ì„œ ì¡°ìš©í•œ ì‹œê°„ì„ ë³´ë‚´ì„¸ìš”.',
                    footer: 'ì˜ˆìƒ ë¹„ìš©: 1ì¸ë‹¹ 10,000ì›',
                    indoor: true
                }
            ]
        };

        // ===== Utility Functions =====
        function getFatigueLevel(score) {
            if (score <= 30) return 'low';
            if (score <= 60) return 'medium';
            return 'high';
        }

        function getFatigueLevelText(level) {
            const labels = { low: 'ë‚®ìŒ', medium: 'ë³´í†µ', high: 'ë†’ìŒ' };
            return labels[level];
        }

        function calculateFatigue(activities) {
            let score = 0;
            activities.forEach((activity, index) => {
                // ê¸°ë³¸ í™œë™ ì‹œê°„ì— ë”°ë¥¸ í”¼ë¡œë„
                score += activity.duration / 30;

                // ì¹´í…Œê³ ë¦¬ë³„ í”¼ë¡œë„
                if (activity.category === 'sight') score += 5;
                if (activity.category === 'shopping') score += 3;
                if (activity.category === 'cafe') score -= 2;

                // ì‹¤ì™¸ í™œë™ ê°€ì¤‘ì¹˜
                if (!activity.indoor) score += 2;

                // ì´ë™ íšŸìˆ˜
                if (index > 0) score += 1;
            });

            return Math.min(100, Math.max(0, Math.round(score)));
        }

        function updateFatigueDisplay(score) {
            const level = getFatigueLevel(score);
            const levelText = getFatigueLevelText(level);

            const valueEl = document.getElementById('fatigue-value');
            const fillEl = document.getElementById('fatigue-fill');

            valueEl.textContent = `${score}ì  (${levelText})`;
            valueEl.className = 'fatigue-value ' + level;

            fillEl.style.width = score + '%';
            fillEl.className = 'fatigue-fill ' + level;
        }

        // ===== Slider Synchronization =====
        function updateSliderValues() {
            const total = state.preferences.food + state.preferences.sight +
                         state.preferences.shopping + state.preferences.cafe;

            document.getElementById('total-percentage').textContent = total;

            // Update displays
            Object.keys(state.preferences).forEach(key => {
                const value = state.preferences[key];
                const valueDisplay = document.querySelector(`[data-slider="${key}"]`);
                const slider = document.querySelector(`input[type="range"][data-slider="${key}"]`);
                const input = document.querySelector(`input[type="number"][data-input="${key}"]`);

                if (valueDisplay) valueDisplay.textContent = value + '%';
                if (slider) slider.value = value;
                if (input) input.value = value;
            });
        }

        function initSliders() {
            // Range sliders
            document.querySelectorAll('input[type="range"][data-slider]').forEach(slider => {
                slider.addEventListener('input', (e) => {
                    const key = e.target.dataset.slider;
                    state.preferences[key] = parseInt(e.target.value);
                    updateSliderValues();
                });
            });

            // Number inputs
            document.querySelectorAll('input[type="number"][data-input]').forEach(input => {
                input.addEventListener('input', (e) => {
                    const key = e.target.dataset.input;
                    let value = parseInt(e.target.value) || 0;
                    value = Math.max(0, Math.min(100, value));
                    state.preferences[key] = value;
                    updateSliderValues();
                });
            });
        }

        // ===== Tab Switching =====
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');

            tabs.forEach((tab, index) => {
                tab.addEventListener('click', () => {
                    // Remove active class from all
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(tc => tc.classList.remove('active'));

                    // Add active class to clicked tab
                    tab.classList.add('active');
                    tabContents[index].classList.add('active');

                    state.currentTab = index;
                });
            });
        }

        // ===== Transport Button Selection =====
        function initTransportButtons() {
            const buttons = document.querySelectorAll('.transport-btn');

            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    // Remove active from all
                    buttons.forEach(b => b.classList.remove('active'));
                    // Add active to clicked
                    button.classList.add('active');
                    state.transport = button.textContent;
                });
            });
        }

        // ===== Itinerary Generation =====
        async function generateItinerary() {
            // Try API first
            try {
                const days = await generateItineraryAPI(state.preferences, 3, state.weather);
                return days;
            } catch (error) {
                console.error('API failed, using local generation', error);
                return generateItineraryLocal();
            }
        }

        function generateItineraryLocal() {
            // Fallback local generation
            const activities = [];
            const activitySource = state.activities.length > 0 ?
                groupActivitiesByCategory(state.activities) :
                activityDatabaseFallback;

            // Get weighted activities based on preferences
            Object.keys(state.preferences).forEach(category => {
                const weight = state.preferences[category];
                const count = Math.round(weight / 25);

                const categoryActivities = activitySource[category] || [];
                for (let i = 0; i < Math.min(count, categoryActivities.length); i++) {
                    activities.push({ ...categoryActivities[i], score: weight * Math.random() });
                }
            });

            // Sort by score
            activities.sort((a, b) => b.score - a.score);

            // Distribute across 3 days
            const days = [[], [], []];
            activities.slice(0, 15).forEach((activity, index) => {
                days[index % 3].push(activity);
            });

            return days;
        }

        function groupActivitiesByCategory(activities) {
            const grouped = { food: [], sight: [], shopping: [], cafe: [] };
            activities.forEach(activity => {
                if (grouped[activity.category]) {
                    grouped[activity.category].push(activity);
                }
            });
            return grouped;
        }

        function renderItinerary(days) {
            const tabContents = document.querySelectorAll('.tab-content');

            days.forEach((dayActivities, dayIndex) => {
                if (!tabContents[dayIndex]) return;

                const scheduleCards = tabContents[dayIndex].querySelector('.schedule-cards');
                if (!scheduleCards) return;

                scheduleCards.innerHTML = '';

                let currentTime = 9 * 60; // Start at 9:00 AM

                dayActivities.forEach((activity, activityIndex) => {
                    const startHour = Math.floor(currentTime / 60);
                    const startMin = currentTime % 60;
                    const endTime = currentTime + activity.duration;
                    const endHour = Math.floor(endTime / 60);
                    const endMin = endTime % 60;

                    const timeStr = `${String(startHour).padStart(2, '0')}:${String(startMin).padStart(2, '0')} - ${String(endHour).padStart(2, '0')}:${String(endMin).padStart(2, '0')} (${activity.duration}ë¶„)`;

                    const travelTime = activityIndex > 0 ? 'ì´ë™ 10ë¶„' : '';

                    const fatigueLevel = activity.indoor ? 'í”¼ë¡œë„ ë‚®ìŒ' : 'í”¼ë¡œë„ ë³´í†µ';

                    const card = document.createElement('div');
                    card.className = 'schedule-card';
                    card.dataset.day = dayIndex;
                    card.dataset.activity = activityIndex;

                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-time">
                                <span class="time-badge">${timeStr}</span>
                                ${travelTime ? `<span class="travel-time">${travelTime}</span>` : ''}
                            </div>
                            <div class="card-badges">
                                <span class="badge badge-fatigue">${fatigueLevel}</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h3 class="card-title">${activity.title}</h3>
                            <div class="card-tags">
                                ${activity.tags.map(tag => {
                                    const colorClass = Math.random() > 0.5 ? 'tag-red' : (Math.random() > 0.5 ? 'tag-blue' : 'tag-green');
                                    return `<span class="tag ${colorClass}">${tag}</span>`;
                                }).join('')}
                            </div>
                            <p class="card-description">${activity.description}</p>
                            <a href="#" class="card-link">ì§€ë„ì—ì„œ ë³´ê¸° â†’</a>
                        </div>
                        ${activity.footer ? `<div class="card-footer">${activity.footer}</div>` : ''}
                        <button class="btn-arrival" data-day="${dayIndex}" data-activity="${activityIndex}">âœ“ ì—¬ê¸° ë„ì°©í–ˆì–´ìš”</button>
                    `;

                    scheduleCards.appendChild(card);

                    // Add travel time for next activity
                    currentTime = endTime + 10;
                });
            });

            // Reinitialize arrival buttons
            initArrivalButtons();

            // Calculate and update fatigue
            const allActivities = days.flat();
            const fatigueScore = calculateFatigue(allActivities);
            updateFatigueDisplay(fatigueScore);
        }

        // ===== Weather-based Alternative Course =====
        async function generateWeatherAlternative() {
            if (state.weather === 'sunny') {
                // Switch to rainy
                state.weather = 'rainy';
                document.getElementById('weather-icon').textContent = 'ğŸŒ§ï¸';
                document.getElementById('weather-condition').textContent = 'ë¹„';
                document.getElementById('weather-temp').textContent = '18Â°C';
                document.getElementById('btn-weather-alternative').textContent = 'â˜€ï¸ ë§‘ì€ ë‚ ì”¨';
            } else {
                // Switch back to sunny
                state.weather = 'sunny';
                document.getElementById('weather-icon').textContent = 'â˜€ï¸';
                document.getElementById('weather-condition').textContent = 'ë§‘ìŒ';
                document.getElementById('weather-temp').textContent = '22Â°C';
                document.getElementById('btn-weather-alternative').textContent = 'â˜” ë¹„ì˜¤ëŠ” ë‚ ì”¨';
            }

            // Regenerate itinerary with new weather
            const days = await generateItinerary();
            renderItinerary(days);
        }

        // ===== Arrival Button & Time Recalculation =====
        function initArrivalButtons() {
            document.querySelectorAll('.btn-arrival').forEach(button => {
                button.addEventListener('click', (e) => {
                    const day = parseInt(e.target.dataset.day);
                    const activity = parseInt(e.target.dataset.activity);

                    const card = e.target.closest('.schedule-card');
                    card.classList.add('arrived');
                    e.target.disabled = true;
                    e.target.textContent = 'âœ“ ë„ì°© ì™„ë£Œ';

                    // Mark next activity as current
                    const allCards = document.querySelectorAll(`.schedule-card[data-day="${day}"]`);
                    allCards.forEach(c => c.classList.remove('current'));

                    if (allCards[activity + 1]) {
                        allCards[activity + 1].classList.add('current');
                    }

                    state.arrivedActivities.push({ day, activity });
                });
            });
        }

        // ===== PDF Generation =====
        function generatePDF() {
            const element = document.querySelector('.main-content');
            const options = {
                margin: 10,
                filename: 'Trip_For_U_ì¼ì •í‘œ.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };

            html2pdf().set(options).from(element).save();
        }

        // ===== Event Listeners =====
        document.getElementById('btn-pdf').addEventListener('click', generatePDF);

        document.getElementById('btn-regenerate').addEventListener('click', async () => {
            const days = await generateItinerary();
            renderItinerary(days);
        });

        document.getElementById('btn-weather-alternative').addEventListener('click', generateWeatherAlternative);

        document.querySelector('.btn-primary').addEventListener('click', async () => {
            const days = await generateItinerary();
            renderItinerary(days);
        });

        // ===== Initialize =====
        async function init() {
            initSliders();
            initTabs();
            initTransportButtons();
            updateSliderValues();

            // Initial fatigue display
            updateFatigueDisplay(42);

            // Load activities from API
            try {
                state.activities = await fetchActivities();
                console.log(`Loaded ${state.activities.length} activities from API`);
            } catch (error) {
                console.error('Failed to load activities from API, using fallback data', error);
            }
        }

        // Run when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
